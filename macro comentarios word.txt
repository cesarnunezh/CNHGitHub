Sub ExportCommentsAndRevisionsToExcel()
    Dim wdDoc As Document
    Dim wdComment As Comment
    Dim wdRevision As Revision
    Dim wdRange As Range
    Dim xlApp As Object
    Dim xlBook As Object
    Dim xlSheet As Object
    Dim i As Long

    ' Referencia al documento de Word
    Set wdDoc = ActiveDocument

    ' Crear una nueva instancia de Excel
    On Error Resume Next
    Set xlApp = GetObject(, "Excel.Application")
    If xlApp Is Nothing Then
        Set xlApp = CreateObject("Excel.Application")
    End If
    On Error GoTo 0

    ' Crear un nuevo libro y hoja en Excel
    Set xlBook = xlApp.Workbooks.Add
    Set xlSheet = xlBook.Sheets(1)

    ' Escribir encabezados en la hoja de Excel
    xlSheet.Cells(1, 1).Value = "Número de Comentario"
    xlSheet.Cells(1, 2).Value = "Comentario"
    xlSheet.Cells(1, 3).Value = "Texto sobre el cual hace el comentario"
    xlSheet.Cells(1, 4).Value = "Página"
    xlSheet.Cells(1, 5).Value = "Sección"

    ' Exportar comentarios
    i = 2
    For Each wdComment In wdDoc.Comments
        Set wdRange = wdComment.Scope
        xlSheet.Cells(i, 1).Value = wdComment.Index
        xlSheet.Cells(i, 2).Value = wdComment.Range.Text
        xlSheet.Cells(i, 3).Value = wdRange.Text
        xlSheet.Cells(i, 4).Value = wdRange.Information(wdActiveEndPageNumber)
        xlSheet.Cells(i, 5).Value = wdRange.Information(wdActiveEndSectionNumber)
        i = i + 1
    Next wdComment

    ' Exportar revisiones
    For Each wdRevision In wdDoc.Revisions
        Set wdRange = wdRevision.Range
        xlSheet.Cells(i, 1).Value = wdRevision.Index
        xlSheet.Cells(i, 2).Value = wdRevision.FormatDescription
        xlSheet.Cells(i, 3).Value = wdRange.Text
        xlSheet.Cells(i, 4).Value = wdRange.Information(wdActiveEndPageNumber)
        xlSheet.Cells(i, 5).Value = wdRange.Information(wdActiveEndSectionNumber)
        i = i + 1
    Next wdRevision

    ' Ajustar las columnas de la hoja de Excel
    xlSheet.Columns("A:E").AutoFit

    ' Mostrar Excel
    xlApp.Visible = True

    ' Liberar objetos
    Set xlSheet = Nothing
    Set xlBook = Nothing
    Set xlApp = Nothing
    Set wdRange = Nothing
    Set wdRevision = Nothing
    Set wdComment = Nothing
    Set wdDoc = Nothing
End Sub
